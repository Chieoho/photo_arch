# -*- coding: utf-8 -*-
"""
@file: check_license.py
@desc:
@author: Jaden Wu
@time: 2021/1/15 10:46
"""
import rsa
import json
import base64
import uuid

priv_key = rsa.PrivateKey(93078744479902710062880762250463990437271483086496100185076384586444857008397996932509055993003885705806474384546394670430824226671587206491822190661123774717397034965284702061403797065471295219354157961512758868737031723235344458088689019469711463248021562617652880711767579269604860116323436396459986077443, 65537, 64074454998105051566090385414799013207463005011631163462619910746867566778062401873905519952459989069036713487935221257556596044773008481024132261408993652662562167052348344139702007740821025866224640928374864823653555621312394544037841233392310186607059467119097426233676641060964556718437817418142108440633, 46896051913594791763289489809989671424510761695936753736991485530176803755184556841269556245276026581316850139039574589790517855300007184442254082045691640473666509, 1984788498856977845649906594246697411050423914584701023967384024606406587577803501803282137065953751596830807635015220281462900611803505551181327)


def get_lic_info():
    with open('license.cer', 'r') as fr:
        license_content = fr.read()
    crypto = base64.b64decode(license_content)
    message = rsa.decrypt(crypto, priv_key)
    info = json.loads(message.decode('utf8'))
    return info


def check_lic(info):
    check_mac = info.get('mac_addr') == hex(uuid.getnode())
    return check_mac


if __name__ == '__main__':
    print(check_lic(get_lic_info()))
